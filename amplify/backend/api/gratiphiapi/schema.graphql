type Sponsor @model @auth(rules: [{ allow: public }]) {
  id: ID!
  name: String!
  logo: String
  identifier: String!
  locations: [Location] @connection(keyName: "bySponsorId", fields: ["id"])
  donees: [Donee] @connection(keyName: "bySponsorId", fields: ["id"])
}

type Location
  @model
  @key(name: "bySponsorId", fields: ["sponsorId"])
  @auth(rules: [{ allow: public }]) {
  id: ID!
  name: String!
  identifier: String!
  sponsorId: ID!
  sponsor: Sponsor @connection(fields: ["sponsorId"])
  donees: [Donee] @connection(keyName: "byLocationId", fields: ["id"])
  donations: [Donation] @connection(keyName: "byLocationId", fields: ["id"])
}

type User @model @auth(rules: [{ allow: public }]) {
  id: ID!
  name: String!
  lastName: String!
  dateOfBirth: AWSDate!
  email: String!
  stripeId: String
  donations: [Donation] @connection(keyName: "byUserId", fields: ["id"])
}

type Donee
  @model
  @key(name: "bySponsorId", fields: ["sponsorId"], queryField: "bySponsorId")
  @key(name: "byLocationId", fields: ["locationId"], queryField: "byLocationId")
  @auth(rules: [{ allow: public }]) {
  id: ID!
  firstName: String!
  lastName: String!
  birthDate: AWSDate!
  smallBiography: String!
  fullBiography: String!
  profilePhoto: String!
  identifier: String!
  sponsor: Sponsor @connection(fields: ["sponsorId"])
  location: Location @connection(fields: ["locationId"])
  donations: [Donation] @connection(keyName: "byDoneeId", fields: ["id"])
  questionAnswer: [QuestionAnswer]
    @connection(keyName: "byDoneeId", fields: ["id"])
}

type Question @model @auth(rules: [{ allow: public }]) {
  id: ID!
  question: String!
}

type QuestionAnswer
  @model
  @key(name: "byQuestionId", fields: ["questionId"])
  @key(name: "byDoneeId", fields: ["doneeId"])
  @auth(rules: [{ allow: public }]) {
  id: ID!
  answer: String!
  questionId: ID!
  question: Question! @connection(fields: ["questionId"])
  doneeId: ID!
  donee: Donee! @connection(fields: ["doneeId"])
}

type Donation
  @model
  @key(name: "byUserId", fields: ["userId"])
  @key(name: "byDoneeId", fields: ["doneeId"])
  @key(name: "byLocationId", fields: ["locationId"], queryField: "byLocationId")
  @auth(rules: [{ allow: public }]) {
  id: ID!
  user: User @connection(fields: ["userId"])
  donee: Donee @connection(fields: ["doneeId"])
  amount: Float
  location: Location @connection(fields: ["locationId"])
  gratification: Gratification @connection(name: "DonationsGratification")
}

type Gratification
  @model
  @key(
    name: "gratificationBySent"
    fields: ["isGratificationSent"]
    queryField: "gratificationBySent"
  )
  @auth(rules: [{ allow: public }]) {
  id: ID!
  gratificationUrl: String
  isGratificationSent: Boolean
  donation: [Donation] @connection(name: "GratificationDonation")
}

type Mutation {
  createPaymentIntent(email: String, userId: String, amount: Float): String
    @function(name: "createPaymentIntent-dev")
}
